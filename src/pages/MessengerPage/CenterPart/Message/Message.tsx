import React, { FC, useState } from 'react'
import { IMessage } from '../../../../types/types';
import classes from './Message.module.scss';
import { CSSTransition } from 'react-transition-group';
import ContextMenu from '../../../../components/ContextMenu/ContextMenu';

interface IMessageComp {
    message: IMessage
}

const Message: FC<IMessageComp> = ({message}) => {
    const [checkedState, setCheckedState] = useState(true)

    const initialContextMenu = {
        show: false,
        x: 0,
        y: 0
    }

    const contextMenuOpen = (e: React.MouseEvent<HTMLDivElement, globalThis.MouseEvent>) => {
        e.preventDefault()
        const {pageX, pageY} = e
        setContextMenu({show: !contextMenu.show, x: pageX, y: pageY})
    }

    const [contextMenu, setContextMenu] = useState(initialContextMenu)

    const contextMenuClose = () => setContextMenu({
        show: false,
        x: contextMenu.x,
        y: contextMenu.y
    })


    return (
        <div className={classes.MessageWrapper} onContextMenu={contextMenuOpen} style={contextMenu.show ? {background: 'rgba(255,255,255, 0.05)'} : {}}>
            <CSSTransition
                in={contextMenu.show}
                unmountOnExit 
                timeout={300}
                classNames="contextMenu"
            >
                <ContextMenu x={contextMenu.x} y={contextMenu.y} closeContextMenu={contextMenuClose}>
                    <ul className={classes.Actions}>
                        <li className={classes.Action}>
                            <div className={classes.Icon}><svg width="24" height="18" viewBox="0 0 24 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.34069 1.81943C9.38116 1.80193 9.42546 1.7947 9.46951 1.79841C9.51357 1.80212 9.55597 1.81665 9.59281 1.84068C9.62966 1.8647 9.65977 1.89744 9.68038 1.93588C9.70099 1.97433 9.71143 2.01725 9.71076 2.0607V4.13667C9.71076 4.37544 9.80726 4.60442 9.97905 4.77325C10.1508 4.94208 10.3838 5.03692 10.6268 5.03692C11.8487 5.03692 14.3146 5.04593 16.6723 6.51693C18.475 7.64044 20.318 9.68581 21.4264 13.4957C19.5577 11.7258 17.4235 10.7661 15.5548 10.2566C14.4062 9.94479 13.2259 9.75999 12.0356 9.70561C11.5483 9.68458 11.0603 9.68939 10.5736 9.72002H10.5498L10.5407 9.72182H10.5388L10.6268 10.6185L10.5352 9.72182C10.3091 9.74415 10.0995 9.84828 9.94712 10.014C9.79477 10.1797 9.71053 10.3951 9.71076 10.6185V12.6944C9.71076 12.8889 9.50924 13.0113 9.34069 12.9357L2.04202 7.65484C2.01725 7.63678 1.99157 7.61996 1.96508 7.60443C1.92525 7.5809 1.89228 7.54765 1.8694 7.50789C1.84652 7.46814 1.83449 7.42324 1.83449 7.37757C1.83449 7.33189 1.84652 7.287 1.8694 7.24724C1.89228 7.20749 1.92525 7.17423 1.96508 7.15071C1.99158 7.13519 2.01726 7.11836 2.04202 7.10029L9.34069 1.81943ZM11.5428 11.4935C11.6673 11.4935 11.8047 11.4989 11.9513 11.5043C12.7464 11.5403 13.8456 11.6592 15.0657 11.9922C17.4949 12.6548 20.3711 14.1564 22.2837 17.5378C22.3872 17.7203 22.552 17.8618 22.7499 17.938C22.9478 18.0142 23.1666 18.0204 23.3686 17.9554C23.5707 17.8905 23.7435 17.7586 23.8574 17.5822C23.9713 17.4058 24.0192 17.1959 23.993 16.9886C23.1429 10.3088 20.5378 6.79421 17.6543 4.99731C15.3735 3.57492 13.0248 3.30124 11.5428 3.24903V2.0607C11.5429 1.68992 11.4413 1.32597 11.2485 1.00726C11.0557 0.688538 10.779 0.426871 10.4475 0.249866C10.116 0.0728604 9.74199 -0.0129205 9.36502 0.00157497C8.98804 0.0160704 8.62203 0.130304 8.30562 0.332223L0.988627 5.62568C0.686128 5.81126 0.436658 6.06944 0.263703 6.37593C0.0907489 6.68241 0 7.02711 0 7.37757C0 7.72803 0.0907489 8.07273 0.263703 8.37921C0.436658 8.68569 0.686128 8.94388 0.988627 9.12945L8.30562 14.4229C8.62203 14.6248 8.98804 14.7391 9.36502 14.7536C9.74199 14.7681 10.116 14.6823 10.4475 14.5053C10.779 14.3283 11.0557 14.0666 11.2485 13.7479C11.4413 13.4292 11.5429 13.0652 11.5428 12.6944V11.4935V11.4935Z" fill="white"/></svg></div>
                            Ответить
                        </li>
                        <li className={classes.Action}>
                            <div className={classes.Icon}><svg width="41" height="49" viewBox="0 0 41 49" fill="none" xmlns="http://www.w3.org/2000/svg"><path fillRule="evenodd" clipRule="evenodd" d="M6.297 0.545468C4.30537 1.2798 2.12913 3.34094 1.10164 5.46623C0.192658 7.34688 0.179359 7.56244 0.0502869 22.2319C-0.0971686 38.9772 -0.0869996 39.0474 2.5144 39.0474C5.06299 39.0474 5.07003 39.0023 5.07003 23.0013C5.07003 7.79194 5.09663 7.55646 7.02606 5.77662C7.82827 5.03631 8.59371 4.96659 17.9198 4.78131C23.437 4.67174 28.1517 4.44941 28.3965 4.28684C29.207 3.75014 29.3924 1.96472 28.7423 0.953871L28.1286 0L17.8705 0.0302817C10.8634 0.0510007 7.19542 0.214362 6.297 0.545468ZM12.4197 7.55447C10.6006 8.13261 8.91913 9.61761 8.1619 11.3162C7.49307 12.8171 7.43401 14.1754 7.43401 28.0902C7.43401 41.9385 7.49542 43.3669 8.15251 44.8248C9.00713 46.7206 9.87935 47.5701 11.8186 48.3956C13.0013 48.8989 15.2362 49.0068 24.3206 48.9997C34.2064 48.9917 35.5507 48.9132 36.963 48.2594C38.6727 47.4685 40.5356 45.4854 40.8739 44.0968C40.9901 43.6207 41.0339 36.1344 40.9717 27.4611L40.8583 11.6911L39.7623 10.228C37.6526 7.41103 37.495 7.38035 24.822 7.29469C18.5835 7.25245 13.0025 7.36959 12.4197 7.55447ZM13.0651 12.9171C12.3376 13.4594 12.3059 14.0897 12.3059 28.044C12.3059 41.491 12.3595 42.6593 13.0045 43.3163C13.6404 43.9646 14.6476 44.0279 24.2838 44.0279H34.865L35.6125 43.0872C36.3173 42.201 36.3603 41.3372 36.3603 28.1348C36.3603 16.0979 36.2747 13.9981 35.7513 13.2375C35.1474 12.3589 35.0547 12.3517 24.4833 12.3517C15.8953 12.3517 13.6768 12.4617 13.0651 12.9171Z" fill="white"></path></svg></div>
                            Копировать текст
                        </li>
                        <li className={classes.Action}>
                            <div className={classes.Icon}><svg width="24" height="18" viewBox="0 0 24 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.6593 1.81943C14.6188 1.80193 14.5745 1.7947 14.5305 1.79841C14.4864 1.80212 14.444 1.81665 14.4072 1.84068C14.3703 1.8647 14.3402 1.89744 14.3196 1.93588C14.299 1.97433 14.2886 2.01725 14.2892 2.0607V4.13667C14.2892 4.37544 14.1927 4.60442 14.021 4.77325C13.8492 4.94208 13.6162 5.03692 13.3732 5.03692C12.1513 5.03692 9.68544 5.04593 7.32766 6.51693C5.52498 7.64044 3.68199 9.68581 2.57363 13.4957C4.44227 11.7258 6.57654 10.7661 8.44518 10.2566C9.59375 9.94479 10.7741 9.75999 11.9644 9.70561C12.4517 9.68458 12.9397 9.68939 13.4264 9.72002H13.4502L13.4593 9.72182H13.4612L13.3732 10.6185L13.4648 9.72182C13.6909 9.74415 13.9005 9.84828 14.0529 10.014C14.2052 10.1797 14.2895 10.3951 14.2892 10.6185V12.6944C14.2892 12.8889 14.4908 13.0113 14.6593 12.9357L21.958 7.65484C21.9827 7.63678 22.0084 7.61996 22.0349 7.60443C22.0748 7.5809 22.1077 7.54765 22.1306 7.50789C22.1535 7.46814 22.1655 7.42324 22.1655 7.37757C22.1655 7.33189 22.1535 7.287 22.1306 7.24724C22.1077 7.20749 22.0748 7.17423 22.0349 7.15071C22.0084 7.13519 21.9827 7.11836 21.958 7.10029L14.6593 1.81943ZM12.4572 11.4935C12.3327 11.4935 12.1953 11.4989 12.0487 11.5043C11.2536 11.5403 10.1544 11.6592 8.93432 11.9922C6.5051 12.6548 3.62886 14.1564 1.71626 17.5378C1.61283 17.7203 1.44803 17.8618 1.2501 17.938C1.05217 18.0142 0.833431 18.0204 0.631379 17.9554C0.429327 17.8905 0.256539 17.7586 0.142625 17.5822C0.0287121 17.4058 -0.0192325 17.1959 0.00700812 16.9886C0.857054 10.3088 3.46215 6.79421 6.34571 4.99731C8.62655 3.57492 10.9752 3.30124 12.4572 3.24903V2.0607C12.4571 1.68992 12.5587 1.32597 12.7515 1.00726C12.9443 0.688538 13.221 0.426871 13.5525 0.249866C13.884 0.0728604 14.258 -0.0129205 14.635 0.00157497C15.012 0.0160704 15.378 0.130304 15.6944 0.332223L23.0114 5.62568C23.3139 5.81126 23.5633 6.06944 23.7363 6.37593C23.9093 6.68241 24 7.02711 24 7.37757C24 7.72803 23.9093 8.07273 23.7363 8.37921C23.5633 8.68569 23.3139 8.94388 23.0114 9.12945L15.6944 14.4229C15.378 14.6248 15.012 14.7391 14.635 14.7536C14.258 14.7681 13.884 14.6823 13.5525 14.5053C13.221 14.3283 12.9443 14.0666 12.7515 13.7479C12.5587 13.4292 12.4571 13.0652 12.4572 12.6944V11.4935V11.4935Z" fill="white"/></svg></div>
                            Переслать
                        </li>
                        <li className={classes.Action}>
                            <div className={classes.Icon}><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"></path></svg></div>
                            Удалить
                        </li>
                        <li className={classes.Action}>
                            <div className={classes.Icon}><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M9.828.722a.5.5 0 0 1 .354.146l4.95 4.95a.5.5 0 0 1 0 .707c-.48.48-1.072.588-1.503.588-.177 0-.335-.018-.46-.039l-3.134 3.134a5.927 5.927 0 0 1 .16 1.013c.046.702-.032 1.687-.72 2.375a.5.5 0 0 1-.707 0l-2.829-2.828-3.182 3.182c-.195.195-1.219.902-1.414.707-.195-.195.512-1.22.707-1.414l3.182-3.182-2.828-2.829a.5.5 0 0 1 0-.707c.688-.688 1.673-.767 2.375-.72a5.922 5.922 0 0 1 1.013.16l3.134-3.133a2.772 2.772 0 0 1-.04-.461c0-.43.108-1.022.589-1.503a.5.5 0 0 1 .353-.146zm.122 2.112v-.002.002zm0-.002v.002a.5.5 0 0 1-.122.51L6.293 6.878a.5.5 0 0 1-.511.12H5.78l-.014-.004a4.507 4.507 0 0 0-.288-.076 4.922 4.922 0 0 0-.765-.116c-.422-.028-.836.008-1.175.15l5.51 5.509c.141-.34.177-.753.149-1.175a4.924 4.924 0 0 0-.192-1.054l-.004-.013v-.001a.5.5 0 0 1 .12-.512l3.536-3.535a.5.5 0 0 1 .532-.115l.096.022c.087.017.208.034.344.034.114 0 .23-.011.343-.04L9.927 2.028c-.029.113-.04.23-.04.343a1.779 1.779 0 0 0 .062.46z"></path></svg></div>
                            Закрепить
                        </li>
                        <li className={classes.Action}>
                            <div className={classes.Icon}><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M14.778.085A.5.5 0 0 1 15 .5V8a.5.5 0 0 1-.314.464L14.5 8l.186.464-.003.001-.006.003-.023.009a12.435 12.435 0 0 1-.397.15c-.264.095-.631.223-1.047.35-.816.252-1.879.523-2.71.523-.847 0-1.548-.28-2.158-.525l-.028-.01C7.68 8.71 7.14 8.5 6.5 8.5c-.7 0-1.638.23-2.437.477A19.626 19.626 0 0 0 3 9.342V15.5a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 1 0v.282c.226-.079.496-.17.79-.26C4.606.272 5.67 0 6.5 0c.84 0 1.524.277 2.121.519l.043.018C9.286.788 9.828 1 10.5 1c.7 0 1.638-.23 2.437-.477a19.587 19.587 0 0 0 1.349-.476l.019-.007.004-.002h.001M14 1.221c-.22.078-.48.167-.766.255-.81.252-1.872.523-2.734.523-.886 0-1.592-.286-2.203-.534l-.008-.003C7.662 1.21 7.139 1 6.5 1c-.669 0-1.606.229-2.415.478A21.294 21.294 0 0 0 3 1.845v6.433c.22-.078.48-.167.766-.255C4.576 7.77 5.638 7.5 6.5 7.5c.847 0 1.548.28 2.158.525l.028.01C9.32 8.29 9.86 8.5 10.5 8.5c.668 0 1.606-.229 2.415-.478A21.317 21.317 0 0 0 14 7.655V1.222z"/></svg></div>
                            Пожаловаться
                        </li>
                    </ul>
                </ContextMenu>
            </CSSTransition>
            <div className={classes.Message}>
                <div className={classes.Text}><span>{message.text}</span></div>
                <div className={classes.TimeStamp}>00:22</div>
                <div className={classes.CheckedIndicator}>
                    {checkedState 
                    ? 
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L2.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093L8.95 4.992a.252.252 0 0 1 .02-.022zm-.92 5.14.92.92a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 1 0-1.091-1.028L9.477 9.417l-.485-.486-.943 1.179z"/></svg> 
                    : 
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/></svg>}
                </div>
            </div>
        </div>
    )
}

export default Message